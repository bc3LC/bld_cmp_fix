library(dplyr)
library(gcamdata)
library(tidyr)
library(ggplot2)
# Fit Coal
serv_coal <- read.csv("serv_coal.csv")
View(serv_coal)
View(serv_coal)
colnames(serv_coal)
formula.coal<- "en_EJ ~ A / (pcgdp_thous * price)  + k"
start.value.coal<-c(A = 1,k = 0.5)
fit_coal<-nls(formula.coal, serv_coal, start.value.coal)
library(dplyr)
library(gcamdata)
library(tidyr)
library(ggplot2)
# Fit Coal
serv_coal <- read.csv("serv_coal.csv")
View(serv_coal)
formula.coal<- "en_EJ ~ A / (pcgdp_thous * price + k)"
# Fit Coal
serv_coal <- read.csv("serv_coal.csv")
formula.coal<- "en_EJ ~ A / (pcgdp_thous * price + k)"
fm0 <- nls(log(en_EJ) ~ log(A / (pcgdp_thous * price + k)), serv_coal, start = c(x = 1, y = 1))
fm0 <- nls(log(en_EJ) ~ log(A / (pcgdp_thous * price + k)), serv_coal, start = c(x = 1, k = 1))
fm0 <- nls(log(en_EJ) ~ log(A / (pcgdp_thous * price + k)), serv_coal, start = c(A = 1, k = 1))
fm0 <- nls(log(en_EJ) ~ log(A / (pcgdp_thous * price + k)), serv_coal %>% filter(complete.cases(.)), start = c(A = 1, k = 1))
View(serv_coal)
formula.coal<- "en_EJ ~ A / (pcgdp_thous * price + k)"
start.value.coal<-c(A = 1, k = 0.5)
fit_coal<-nls(formula.coal, serv_coal, start.value.coal)
View(serv_coal)
library(dplyr)
library(gcamdata)
library(tidyr)
library(ggplot2)
# Fit Coal
serv_coal <- read.csv("serv_coal.csv")
formula.coal<- "en_EJ ~ A / (afford + k)"
formula.coal.new<- "en_EJ ~ A / (pcgdp_thous * price + k)"
start.value.coal<-c(A = 1, k = 0.5)
fit_coal<-nls(formula.coal, serv_coal, start.value.coal)
A_coal<-coef(fit_coal)[1]
k_coal<-coef(fit_coal)[2]
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
fm0 <- nls(log(en_EJ) ~ log(A / (pcgdp_thous * price + k)), serv_coal, start = c(A = 1, k = 0.05))
# Fit Coal
serv_coal <- read.csv("serv_coal.csv") %>%
select(-afford)
View(serv_coal)
formula.coal.new<- "en_EJ ~ A / (pcgdp_thous * price + k)"
fm0 <- nls(log(en_EJ) ~ log(A / (pcgdp_thous * price + k)), serv_coal, start = c(A = 1, k = 0.05))
formula.coal.new<- "en_EJ ~ A / (pcgdp_thous * price + k)"
start.value.coal<-c(A = 1, k = 0.5)
fit_coal<-minpack.lm::nlsLM(formula.coal.new, serv_coal, start.value.coal)
summary(fit_coal)
fit_coal$m
A_coal<-coef(fit_coal)[1]
k_coal<-coef(fit_coal)[2]
A_coal
k_coal
View(serv_coal)
View(serv_coal)
serv_coal_check <- serv_coal %>%
mutate(A = A_coal,
k = k_coal) %>%
mutate(est_en_EJ = A / (pcgdp_thous * price + k))
View(serv_coal_check)
formula.coal.new<- "en_EJ ~ A / (pcgdp_thous * price)"
start.value.coal<-c(A = 1)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
library(dplyr)
library(gcamdata)
library(tidyr)
library(ggplot2)
# Fit Coal
serv_coal <- read.csv("serv_coal.csv") %>%
select(-afford)
formula.coal.new<- "en_EJ ~ A / (pcgdp_thous * price)"
start.value.coal<-c(A = 1)
fit_coal<-minpack.lm::nlsLM(formula.coal.new, serv_coal, start.value.coal)
source("C:/Users/jon.sampedro/Desktop/CMP_fix/fit_trad_function.R", echo=TRUE)
# Fit Coal
serv_coal <- read.csv("serv_coal.csv") %>%
select(-afford)
formula.coal.new<- "en_EJ ~ A / (pcgdp_thous * price)"
start.value.coal <- c(A = 1)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
start.value.coal <- c(A = 0)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 0.1))
formula.coal.new<- "en_EJ  ~ A / (pcgdp_thous * price / 1E6)"
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 1))
start.value.coal <- c(A = 0)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
View(serv_coal)
# Fit Coal
serv_coal <- read.csv("serv_coal.csv") %>%
filter(en_EJ != 0) %>%
select(-afford)
formula.coal.new<- "en_EJ  ~ A / (pcgdp_thous * price)"
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 1))
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 0))
start.value.coal <- c(A = 0)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 1000))
formula.coal.new<- "en_EJ  ~ A / (pcgdp_thous * price / 1E6)"
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 1))
library(dplyr)
library(gcamdata)
library(tidyr)
library(ggplot2)
# Fit Coal
serv_coal <- read.csv("serv_coal.csv") %>%
filter(en_EJ != 0) %>%
select(-afford)
formula.coal.new<- "en_EJ  ~ A / (pcgdp_thous * price / 1E6)"
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 1))
# Fit Coal
serv_coal <- read.csv("serv_coal.csv") %>%
filter(en_EJ != 0) %>%
select(-afford)
View(serv_coal)
formula.coal.new<- "en_EJ  ~ A / (pcgdp_thous * price + k)"
fm0 <- nls(log(en_EJ) ~ log(A/(pcgdp_thous * price)), serv_coal, start = c(A = 1))
formula.coal.new<- "en_EJ  ~ (A / pcgdp_thous) + (k / price))"
start.value.coal <- c(A = 1, k = 1)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
formula.coal.new<- "en_EJ  ~ (A / pcgdp_thous) + (k / price)"
start.value.coal <- c(A = 1, k = 1)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
detach(serv_coal)
plot(serv_coal$pcgdp_thous, serv_coal$en_EJ)
plot(serv_coal$price, serv_coal$en_EJ)
View(serv_coal)
serv_coal <- read.csv("serv_coal.csv")
plot(serv_coal$price, serv_coal$en_EJ)
library(dplyr)
library(gcamdata)
library(tidyr)
library(ggplot2)
# Load data
serv_coal <- read.csv("input/serv_coal.csv")
serv_TradBio <- read.csv("input/serv_TradBio.csv")
View(serv_TradBio)
formula.tradBio<- "en_EJ ~ x / (pcgdp_thous + y)"
start.value.tradBio<-c(x = 10,y = 10)
fit_tradBio<-nls(formula.tradBio, serv_TradBio, start.value.tradBio)
# Manual starting values
start.value.coal <- c(A = 1, k = 1)
fit_coal<-nls(formula.coal.new, serv_coal, start.value.coal)
fit_coal<-nls(formula.coal, serv_coal, start.value.coal)
formula.coal<- "en_EJ  ~ (A / pcgdp_thous) + (k / price)"
fit_coal<-nls(formula.coal, serv_coal, start.value.coal)
A_coal<-coef(fit_coal)[1]
k_coal<-coef(fit_coal)[2]
